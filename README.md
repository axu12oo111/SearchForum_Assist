# Discordè®ºå›æœç´¢æœºå™¨äºº

ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„Discordæœºå™¨äººï¼Œä¸“ä¸ºå¤§å‹æœåŠ¡å™¨è®¾è®¡ï¼Œæä¾›é«˜çº§è®ºå›å¸–å­æœç´¢å’Œå†…å®¹ç®¡ç†åŠŸèƒ½ã€‚é€šè¿‡é«˜æ•ˆçš„ç¼“å­˜ç³»ç»Ÿå’Œä¼˜åŒ–çš„æœç´¢ç®—æ³•ï¼Œå³ä½¿åœ¨æ‹¥æœ‰å¤§é‡ç”¨æˆ·å’Œå¸–å­çš„æœåŠ¡å™¨ä¸­ä¹Ÿèƒ½ä¿æŒå‡ºè‰²æ€§èƒ½ã€‚

## åŠŸèƒ½ç‰¹ç‚¹

- **é«˜çº§æœç´¢è¯­æ³•**ï¼šæ”¯æŒANDã€ORã€NOTç­‰å¤æ‚é€»è¾‘æ“ä½œç¬¦å’Œç²¾ç¡®çŸ­è¯­åŒ¹é…
- **å¤šç»´åº¦è¿‡æ»¤**ï¼šæŒ‰æ ‡ç­¾ã€ä½œè€…ã€æ—¥æœŸèŒƒå›´ã€ååº”æ•°å’Œå›å¤æ•°ç­‰å¤šæ¡ä»¶ç­›é€‰
- **æ™ºèƒ½æ’åº**ï¼šæ”¯æŒ8ç§æ’åºæ–¹å¼ï¼ŒåŒ…æ‹¬ååº”æ•°ã€å›å¤æ•°ã€å‘å¸–æ—¶é—´å’Œæœ€åæ´»è·ƒæ—¶é—´
- **å®æ—¶æœç´¢è¿›åº¦**ï¼šæœç´¢è¿‡ç¨‹ä¸­æ˜¾ç¤ºå®æ—¶è¿›åº¦å’Œç»Ÿè®¡ä¿¡æ¯ï¼Œæ”¯æŒå–æ¶ˆé•¿æ—¶é—´è¿è¡Œçš„æœç´¢
- **åˆ†é¡µæµè§ˆç»“æœ**ï¼šç›´è§‚çš„ç•Œé¢æ§åˆ¶ï¼Œè½»æ¾æµè§ˆå¤§é‡æœç´¢ç»“æœ
- **è‡ªåŠ¨å®Œæˆå»ºè®®**ï¼šè¾“å…¥æ—¶æä¾›æ™ºèƒ½å»ºè®®ï¼Œä¼˜å…ˆæ˜¾ç¤ºæœ€è¿‘ä½¿ç”¨çš„é€‰é¡¹
- **æœç´¢å†å²è®°å½•**ï¼šä¿å­˜ç”¨æˆ·æœ€è¿‘çš„æœç´¢è®°å½•ï¼Œæ–¹ä¾¿é‡å¤æŸ¥è¯¢
- **æ€§èƒ½ç›‘æ§ç³»ç»Ÿ**ï¼šå†…ç½®è¯¦ç»†çš„æ€§èƒ½ç»Ÿè®¡å’Œèµ„æºä½¿ç”¨ç›‘æ§
- **å¤§å‹æœåŠ¡å™¨ä¼˜åŒ–**ï¼šä¸“ä¸ºé«˜æµé‡å¤§å‹æœåŠ¡å™¨(10000+ç”¨æˆ·)è®¾è®¡ï¼Œæ”¯æŒRedisç¼“å­˜

## å®‰è£…è¯´æ˜

### ç¯å¢ƒè¦æ±‚

- Python 3.11.x
- Discord.py v2.3+
- å¯é€‰ï¼šRedisæœåŠ¡å™¨ï¼ˆç”¨äºé«˜çº§ç¼“å­˜ï¼‰
- æœºå™¨äººéœ€è¦çš„æƒé™ï¼š
  - è¯»å–æ¶ˆæ¯
  - å‘é€æ¶ˆæ¯
  - åµŒå…¥é“¾æ¥
  - æ·»åŠ ååº”
  - è¯»å–æ¶ˆæ¯å†å²
  - æŸ¥çœ‹é¢‘é“

### å®‰è£…æ­¥éª¤

1. å…‹éš†é¡¹ç›®ä»“åº“ï¼š

    ```bash
    git clone https://github.com/yourusername/discord-forum-search-bot.git
    cd discord-forum-search-bot
    ```

2. å®‰è£…ä¾èµ–é¡¹ï¼š

    ```bash
    pip install -r requirements.txt
    ```

3. åˆ›å»ºå¹¶é…ç½®ç¯å¢ƒå˜é‡æ–‡ä»¶(`.env`)ï¼š

    ```env
    DISCORD_TOKEN=your_bot_token_here
    ```

4. è¿è¡Œæœºå™¨äººï¼š

    ```bash
    python main.py
    ```

### Dockeréƒ¨ç½²ï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰

ä½¿ç”¨Docker Composeå¿«é€Ÿéƒ¨ç½²ï¼ˆåŒ…å«Redisç¼“å­˜ï¼‰ï¼š

```bash
# é…ç½®ç¯å¢ƒå˜é‡
echo "DISCORD_TOKEN=your_bot_token_here" > .env

# å¯åŠ¨æœåŠ¡
docker-compose up -d
```

## ä½¿ç”¨æŒ‡å—

### æœç´¢å‘½ä»¤

åŸºæœ¬æœç´¢ï¼š

```bash
/forum_search forum_name:[è®ºå›åç§°] search_word:[æœç´¢å…³é”®è¯]
```

é«˜çº§æœç´¢è¯­æ³•ï¼š

- ANDæœç´¢: `term1 AND term2` æˆ– `term1 & term2`
- ORæœç´¢: `term1 OR term2` æˆ– `term1 | term2`
- NOTæœç´¢: `NOT term` æˆ– `-term`
- ç²¾ç¡®çŸ­è¯­: `"exact phrase"`
- ç»„åˆä½¿ç”¨: `(term1 OR term2) AND NOT term3`

å¤šæ¡ä»¶è¿‡æ»¤ï¼š

```bash
/forum_search forum_name:[è®ºå›åç§°] tag1:[æ ‡ç­¾1] tag2:[æ ‡ç­¾2] original_poster:[ç”¨æˆ·] min_reactions:[æ•°é‡] start_date:[æ—¥æœŸ]
```

æ’åºé€‰é¡¹ï¼š

```bash
/forum_search forum_name:[è®ºå›åç§°] order:[æ’åºæ–¹å¼]
```

æ”¯æŒçš„æ’åºæ–¹å¼ï¼šæœ€é«˜ååº”é™åº/å‡åºã€æ€»å›å¤æ•°é™åº/å‡åºã€å‘å¸–æ—¶é—´ç”±æ–°åˆ°æ—§/ç”±æ—§åˆ°æ–°ã€æœ€åæ´»è·ƒç”±æ–°åˆ°æ—§/ç”±æ—§åˆ°æ–°

### å…¶ä»–å®ç”¨å‘½ä»¤

æŸ¥çœ‹æœç´¢è¯­æ³•å¸®åŠ©ï¼š

```bash
/search_syntax
```

æŸ¥çœ‹æœç´¢å†å²ï¼š

```bash
/search_history
```

æŸ¥çœ‹æœºå™¨äººæ€§èƒ½ç»Ÿè®¡ï¼š

```bash
/bot_stats
```

æŸ¥çœ‹æœåŠ¡å™¨ç»Ÿè®¡ä¿¡æ¯ï¼š

```bash
/server_stats
```

### åˆ†é¡µæ§åˆ¶

- â®ï¸: ç¬¬ä¸€é¡µ
- â—€ï¸: ä¸Šä¸€é¡µ
- â–¶ï¸: ä¸‹ä¸€é¡µ
- â­ï¸: æœ€åä¸€é¡µ
- ğŸ”¢: è·³è½¬åˆ°æŒ‡å®šé¡µé¢
- ğŸ”„: åˆ·æ–°ç»“æœ
- âŒ: å…³é—­æœç´¢ç»“æœ

## éƒ¨ç½²å’Œç»´æŠ¤æŒ‡å—

### ç³»ç»Ÿè¦æ±‚

#### æœ€ä½è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: Linux (Ubuntu 20.04+), macOS 10.15+, Windows 10+
- **Python**: 3.11 æˆ–æ›´é«˜ç‰ˆæœ¬
- **å†…å­˜**: 512MB RAM (å°å‹æœåŠ¡å™¨)
- **å­˜å‚¨**: 1GB å¯ç”¨ç©ºé—´

#### æ¨èé…ç½®
- **æ“ä½œç³»ç»Ÿ**: Ubuntu 22.04 LTS
- **Python**: 3.11+
- **å†…å­˜**: 2GB+ RAM (å¤§å‹æœåŠ¡å™¨)
- **å­˜å‚¨**: 5GB+ SSD
- **CPU**: 2+ æ ¸å¿ƒ

### ä¾èµ–æœåŠ¡é…ç½®

#### RedisæœåŠ¡å™¨ (æ¨è)
```bash
# Ubuntu/Debian å®‰è£…
sudo apt update
sudo apt install redis-server
sudo systemctl start redis-server
sudo systemctl enable redis-server

# éªŒè¯å®‰è£…
redis-cli ping  # åº”è¿”å› PONG
```

#### Dockeræ–¹å¼å®‰è£…Redis
```bash
docker run -d \
  --name discord-bot-redis \
  -p 6379:6379 \
  -v redis-data:/data \
  redis:7-alpine redis-server --appendonly yes
```

### åº”ç”¨éƒ¨ç½²

#### 1. è·å–æºä»£ç 
```bash
git clone https://github.com/your-username/discord-forum-search-assistant.git
cd discord-forum-search-assistant
```

#### 2. ç¯å¢ƒå‡†å¤‡
```bash
# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python3.11 -m venv venv
source venv/bin/activate  # Linux/macOS

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

#### 3. é…ç½®è®¾ç½®
```bash
# å¤åˆ¶ç¯å¢ƒå˜é‡æ¨¡æ¿
cp .env.example .env

# ç¼–è¾‘é…ç½®æ–‡ä»¶
nano .env
```

#### å¿…éœ€çš„ç¯å¢ƒå˜é‡
```env
# Discord Bot Token (å¿…éœ€)
DISCORD_TOKEN=your_discord_bot_token_here

# Redisé…ç½® (å¯é€‰ä½†æ¨è)
USE_REDIS_CACHE=true
REDIS_URL=redis://localhost:6379/0

# ç¼“å­˜è®¾ç½®
CACHE_TTL=600
THREAD_CACHE_SIZE=1000

# æœç´¢é™åˆ¶
MAX_MESSAGES_PER_SEARCH=1000
CONCURRENT_SEARCH_LIMIT=5
```

#### 4. Discord Botè®¾ç½®
1. è®¿é—® [Discord Developer Portal](https://discord.com/developers/applications)
2. åˆ›å»ºæ–°åº”ç”¨å¹¶ç”ŸæˆBot Token
3. è®¾ç½®å¿…éœ€æƒé™ï¼š
   - Send Messages (å‘é€æ¶ˆæ¯)
   - Use Slash Commands (ä½¿ç”¨æ–œæ å‘½ä»¤)
   - Embed Links (åµŒå…¥é“¾æ¥)
   - Read Message History (è¯»å–æ¶ˆæ¯å†å²)
   - View Channels (æŸ¥çœ‹é¢‘é“)

#### 5. å¯åŠ¨åº”ç”¨

**å¼€å‘ç¯å¢ƒ**
```bash
python main.py
```

**ç”Ÿäº§ç¯å¢ƒ (systemd)**
```bash
# åˆ›å»ºæœåŠ¡æ–‡ä»¶
sudo nano /etc/systemd/system/discord-bot.service

# å¯ç”¨æœåŠ¡
sudo systemctl enable discord-bot
sudo systemctl start discord-bot
```

**Dockeréƒ¨ç½²**
```bash
# æ„å»ºé•œåƒ
docker build -t discord-forum-search-assistant .

# è¿è¡Œå®¹å™¨
docker run -d \
  --name discord-bot \
  --restart unless-stopped \
  -v $(pwd)/data:/app/data \
  --env-file .env \
  discord-forum-search-assistant
```

**Docker Composeéƒ¨ç½²**
```bash
# ä½¿ç”¨æä¾›çš„ docker-compose.yml
docker-compose up -d

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f discord-bot
```

### å¤§å‹æœåŠ¡å™¨ä¼˜åŒ–å»ºè®®

å¯¹äºæ‹¥æœ‰10000+ç”¨æˆ·å’Œå¤§é‡å¸–å­çš„æœåŠ¡å™¨ï¼Œå»ºè®®ä»¥ä¸‹é…ç½®ï¼š

1. åœ¨`config/config.py`ä¸­è°ƒæ•´ä»¥ä¸‹å‚æ•°ï¼š
   - é™ä½ `MAX_MESSAGES_PER_SEARCH` è‡³åˆç†å€¼(å¦‚500-1000)
   - å¢åŠ  `CACHE_TTL` è‡³5-10åˆ†é’Ÿ
   - å¢åŠ  `REACTION_TIMEOUT` ä»¥å»¶é•¿ä¼šè¯æœ‰æ•ˆæœŸ

2. å¯ç”¨é«˜çº§ç¼“å­˜è®¾ç½®ï¼š
   - è®¾ç½® `USE_REDIS_CACHE=True` (éœ€è¦é¢å¤–å®‰è£…Redis)
   - é…ç½® `THREAD_CACHE_SIZE` ä»¥é€‚åº”æœåŠ¡å™¨è§„æ¨¡

3. åœ¨æœåŠ¡å™¨ç®¡ç†å‘˜è®¾ç½®ä¸­ï¼š
   - é™åˆ¶ä½¿ç”¨æœºå™¨äººçš„é¢‘é“
   - è®¾ç½®åˆç†çš„å‘½ä»¤å†·å´æ—¶é—´
   - å®šæœŸç›‘æ§èµ„æºä½¿ç”¨æƒ…å†µ

## æ€§èƒ½ç›‘æ§

å¯ç”¨å†…ç½®çš„æ€§èƒ½ç›‘æ§ï¼š
```
/bot_stats
```
æŸ¥çœ‹æœºå™¨äººè¿è¡ŒçŠ¶æ€ã€å“åº”æ—¶é—´å’Œèµ„æºä½¿ç”¨æƒ…å†µã€‚

### ç›‘æ§å’Œç»´æŠ¤

#### å¥åº·æ£€æŸ¥
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
sudo systemctl status discord-bot

# æŸ¥çœ‹ç¼“å­˜ç»Ÿè®¡
# åœ¨Discordä¸­ä½¿ç”¨: /bot_stats

# æ£€æŸ¥RedisçŠ¶æ€
redis-cli info memory
```

#### æ—¥å¿—ç®¡ç†
```bash
# æŸ¥çœ‹å®æ—¶æ—¥å¿—
tail -f logs/discord_bot.log

# æŸ¥çœ‹é”™è¯¯æ—¥å¿—
grep ERROR logs/discord_bot.log | tail -20
```

#### å¤‡ä»½ç­–ç•¥
```bash
# æ¯æ—¥æ•°æ®å¤‡ä»½
tar -czf backup/data_$(date +%Y%m%d).tar.gz data/

# Redisæ•°æ®å¤‡ä»½
redis-cli BGSAVE
cp /var/lib/redis/dump.rdb backup/redis_$(date +%Y%m%d).rdb
```

### è¯¦ç»†æ–‡æ¡£

- [ç³»ç»Ÿæ¶æ„è¯´æ˜](docs/architecture.md)
- [è¯¦ç»†éƒ¨ç½²æŒ‡å—](docs/deployment.md)
- [è¿ç»´æ‰‹å†Œ](docs/maintenance.md)
- [æ•…éšœæ’é™¤æŒ‡å—](docs/troubleshooting.md)

## æ€§èƒ½ç›‘æ§

æœºå™¨äººå†…ç½®äº†è¯¦ç»†çš„æ€§èƒ½ç›‘æ§ç³»ç»Ÿï¼š

```bash
/bot_stats
```

ç›‘æ§å†…å®¹åŒ…æ‹¬ï¼š

- ç³»ç»Ÿèµ„æºä½¿ç”¨æƒ…å†µï¼ˆCPUã€å†…å­˜ã€çº¿ç¨‹æ•°ï¼‰
- æœç´¢ç»Ÿè®¡ï¼ˆæ€»æ¬¡æ•°ã€æˆåŠŸç‡ã€å¹³å‡æ—¶é—´ã€å³°å€¼å¹¶å‘ï¼‰
- ç¼“å­˜æ•ˆç‡ï¼ˆå‘½ä¸­ç‡ã€ç¼“å­˜å¤§å°ï¼‰
- æœ€å¸¸ç”¨å‘½ä»¤ç»Ÿè®¡
- æœ€æ´»è·ƒæœåŠ¡å™¨æ•°æ®
- ç½‘ç»œå’Œè¿æ¥çŠ¶æ€

è¿˜å¯ä»¥æŸ¥çœ‹å½“å‰æœåŠ¡å™¨çš„è¯¦ç»†ç»Ÿè®¡ä¿¡æ¯ï¼š

```bash
/server_stats
```

## æ•…éšœæ’é™¤

å¸¸è§é—®é¢˜ï¼š

- **æœºå™¨äººæ— å“åº”**ï¼šæ£€æŸ¥TOKENé…ç½®å’Œç½‘ç»œè¿æ¥
- **æœç´¢ç»“æœä¸ºç©º**ï¼šç¡®è®¤æœºå™¨äººæœ‰é€‚å½“çš„é¢‘é“è®¿é—®æƒé™
- **åŠ è½½ç¼“æ…¢**ï¼šè€ƒè™‘è°ƒæ•´ç¼“å­˜å’Œåˆ†é¡µè®¾ç½®
- **å‘½ä»¤é”™è¯¯**ï¼šæŸ¥çœ‹æ—¥å¿—è·å–è¯¦ç»†é”™è¯¯ä¿¡æ¯

## è®¸å¯è¯

MIT License

## è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç ã€æŠ¥å‘Šé—®é¢˜æˆ–æå‡ºæ”¹è¿›å»ºè®®ã€‚è¯·æäº¤Pull Requestæˆ–å¼€Issueè®¨è®ºã€‚